<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rancher user cluster configuration | Rancher on HPE SimpliVity</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="">
    <link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/css/0.styles.3380d368.css" as="style"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/app.cb329883.js" as="script"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/2.568917a2.js" as="script"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/5.5f15ab02.js" as="script"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/10.06c43cf5.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/11.4c7b6590.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/12.09e9497f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/13.cf9107b0.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/14.6b37f814.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/15.21bcd338.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/16.7a493f47.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/17.12ff4be1.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/18.6ee7966c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/19.be02d0a8.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/20.f1334240.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/21.a2bbc1cc.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/22.55a36f40.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/23.80b69d5e.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/24.0357e388.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/25.b266b0ec.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/26.5c01dad6.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/27.7c499a5f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/28.2fd159a9.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/29.ba7ad96c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/3.4076c4db.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/30.ce362c92.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/31.f0416b2b.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/32.c5aecde9.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/33.4aeac3b1.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/34.825193f8.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/35.2c62f183.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/36.7b16d7da.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/37.58d6c27e.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/38.2ec03593.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/39.43ba15c4.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/4.e11c904b.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/40.722542ca.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/41.d96eca0a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/42.cebcf80c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/43.44e36c9f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/44.4bd56e60.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/45.ae30f4e1.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/46.ea04525d.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/47.1182fb4a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/6.ebbb2527.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/7.e1a75b56.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/8.48064e5e.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/9.b8caf523.js">
    <link rel="stylesheet" href="/Rancher-on-SimpliVity/MVI1/assets/css/0.styles.3380d368.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Rancher-on-SimpliVity/MVI1/" class="home-link router-link-active"><!----> <span class="site-name">Rancher on HPE SimpliVity</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/blog/" class="nav-link">
  Blog
</a></div> <a href="https://github.com/Rancher-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/blog/" class="nav-link">
  Blog
</a></div> <a href="https://github.com/Rancher-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Rancher-on-SimpliVity/MVI1/summary.html" class="sidebar-link">Executive summary</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Preparing the environment </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Configuring the solution</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/ansible-config.html" class="sidebar-link">Ansible configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/proxy-config.html" class="sidebar-link">Proxy configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/edit-hosts.html" class="sidebar-link">Editing the hosts file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vmware-config.html" class="sidebar-link">VMware configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/simplivity-config.html" class="sidebar-link">HPE SimpliVity configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/networking-config.html" class="sidebar-link">Networking configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-config.html" class="sidebar-link">Admin cluster and Rancher server configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html" class="active sidebar-link">Rancher user cluster configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html#general-config-for-user-cluster" class="sidebar-link">General config for user cluster</a></li><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html#configuration-of-pools" class="sidebar-link">Configuration of pools</a></li><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html#node-templates" class="sidebar-link">Node templates</a></li><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html#sample-user-cluster-definition" class="sidebar-link">Sample user cluster definition</a></li></ul></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/lbs-config.html" class="sidebar-link">Load balancer configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/csi-storage-config.html" class="sidebar-link">Container Storage Interface (CSI) configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/group-vars.html" class="sidebar-link">Inventory group variables</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/edit-vault.html" class="sidebar-link">Protecting sensitive information</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vars-sample.html" class="sidebar-link">Sample vars file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vault-sample.html" class="sidebar-link">Sample vault file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/hosts-sample.html" class="sidebar-link">Sample hosts file</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Running the playbooks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Post deployment tasks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Appendices</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rancher-user-cluster-configuration"><a href="#rancher-user-cluster-configuration" class="header-anchor">#</a> Rancher user cluster configuration</h1> <p>Once the admin cluster has been deployed and Rancher server has been installed, the playbooks deploy a
user cluster based on the following configuration.</p> <h2 id="general-config-for-user-cluster"><a href="#general-config-for-user-cluster" class="header-anchor">#</a> General config for user cluster</h2> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>user_folder</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Folder and pool name for the user cluster VMs</td></tr> <tr><td style="text-align:left;"><code>user_cluster.name</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The name of the user cluster</td></tr> <tr><td style="text-align:left;"><code>user_cluster.vcenter_credsname</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The name given to the generated Cloud Credentials</td></tr> <tr><td style="text-align:left;"><code>user_cluster.csi</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Boolean. Set to <code>true</code> to configure the CSI driver on the user cluster</td></tr> <tr><td style="text-align:left;"><code>user_cluster.vm_template</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The VM template to use when creating the nodes in the suer cluster.<br>Defaults to the admin template if none specified.</td></tr></tbody></table> <p>For more information on configuring the CSI driver for a user cluster, see the section <a href="csi-storage-config">Container Storage Interface (CSI) configuration</a>.</p> <p><br><br></p> <p>The following figure shows the generated cloud credentials in the UI, accessed via your profile:</p> <p><img src="/Rancher-on-SimpliVity/MVI1/assets/img/cloud-credentials.8f2243e5.png" alt="&quot;Cloud credentials&quot;" title="Figure. Cloud credentials"></p> <p><strong>Figure. Cloud credentials</strong></p> <h2 id="configuration-of-pools"><a href="#configuration-of-pools" class="header-anchor">#</a> Configuration of pools</h2> <p><code>user_cluster.pools</code> is an array of pool configurations, with typically one pool specified for master nodes,
and one pool for worker nodes. Note that the cluster must have at least one master node, one etcd node and one worker node.</p> <p>The configuration variables used within each pool definition are detailed below.</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>name</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The name of the pool, for example <code>master-pool</code> or <code>worker-pool</code></td></tr> <tr><td style="text-align:left;"><code>etcd</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Boolean.<code>true</code> if you want <code>etcd</code> to run on nodes in this pool</td></tr> <tr><td style="text-align:left;"><code>master</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Boolean.<code>true</code> if you want the nodes in this pool to be <code>master</code> nodes</td></tr> <tr><td style="text-align:left;"><code>worker</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Boolean.<code>true</code> if you want the nodes in this pool to be <code>worker</code> nodes<br>Note that a node can act as both a master and a worker node</td></tr> <tr><td style="text-align:left;"><code>count</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Number of nodes of this type to create.</td></tr> <tr><td style="text-align:left;"><code>hostPrefix</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The prefix used to identify these nodes as belonging to this pool<br>Typically, you will specify a different prefix for master and worker nodes</td></tr></tbody></table> <h2 id="node-templates"><a href="#node-templates" class="header-anchor">#</a> Node templates</h2> <p>For each pool, a node template can be specified with resource configuration appropriate to the node type
of the pool.</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>node_template.name</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The name of the generated node template</td></tr> <tr><td style="text-align:left;"><code>node_template.cpu_count</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The number of virtual CPUs for the node</td></tr> <tr><td style="text-align:left;"><code>node_template.disk_size</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The size of disk in MB to create for the node</td></tr> <tr><td style="text-align:left;"><code>node_template.disk_size</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">The size of RAM in MB</td></tr></tbody></table> <p><br><br></p> <p>The following figure shows the generated node templates in the UI, accessed via your profile:</p> <p><img src="/Rancher-on-SimpliVity/MVI1/assets/img/node-templates.86bee9c0.png" alt="&quot;Node templates&quot;" title="Figure. Node templates"></p> <p><strong>Figure. Node templates</strong></p> <h2 id="sample-user-cluster-definition"><a href="#sample-user-cluster-definition" class="header-anchor">#</a> Sample user cluster definition</h2> <p>The sample definition has one master pool, with a single node containing the master and etcd components. There is also
a single worker pool, with 2 nodes that only run worker components. In this example, the VM template is not specified
so the default is to use the same template as that used for the Rancher admin cluster</p> <div class="language- extra-class"><pre class="language-text"><code>user_cluster:
# vm_template: hpe-ubuntu-tpl     # an existing VM template, the admin template by default
  name: api                       # name of the user cluster
  csi: false                      # true to be done
  vcenter_credsname: mycreds2     # only one vCenter cluster supported at this time
  pools:
   - name: master-pool
     etcd: true
     master: true
     worker: false
     count: 1
     hostPrefix: hpe-mas
     node_template:
       name: master-node
       cpu_count: 2
       disk_size: 20000
       memory_size: 8192
   - name: worker-pool
     etcd: false
     master: false
     worker: true
     count: 2
     hostPrefix: hpe-wrk
     node_template:
       name: worker-node
       cpu_count: 2
       disk_size: 40000
       memory_size: 4096
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/HewlettPackard/Rancher-on-SimpliVity/edit/docs-dev/docs-src/config-core/rancher-user-config.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-config.html" class="prev">
        Admin cluster and Rancher server configuration
      </a></span> <span class="next"><a href="/Rancher-on-SimpliVity/MVI1/config-core/lbs-config.html">
        Load balancer configuration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Rancher-on-SimpliVity/MVI1/assets/js/app.cb329883.js" defer></script><script src="/Rancher-on-SimpliVity/MVI1/assets/js/2.568917a2.js" defer></script><script src="/Rancher-on-SimpliVity/MVI1/assets/js/5.5f15ab02.js" defer></script>
  </body>
</html>
