<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Admin cluster and Rancher server configuration | Rancher on HPE SimpliVity</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="">
    <link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/css/0.styles.1c70c719.css" as="style"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/app.f53704fe.js" as="script"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/2.753eaf12.js" as="script"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/3.edbce201.js" as="script"><link rel="preload" href="/Rancher-on-SimpliVity/MVI1/assets/js/20.9c939912.js" as="script"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/10.2e79c8de.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/11.bbed083b.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/12.4b5b2bac.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/13.786ed55d.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/14.e45c681f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/15.953e1ce5.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/16.e289344a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/17.57bf2404.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/18.a36b0d5e.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/19.d14580f2.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/21.4dc19d4b.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/22.1c12f48a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/23.dee01f93.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/24.096d0f9c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/25.dc32a0f7.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/26.ea3f3b31.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/27.42f27881.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/28.47859091.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/29.bd3f4603.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/30.0c4c11de.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/31.4068877a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/32.3e249d30.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/33.32a30f7c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/34.569a5507.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/35.e534804f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/36.6587915e.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/37.a5e0f37c.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/38.169e081d.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/39.77dcf2bd.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/4.214a3e1f.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/40.337280c7.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/41.3bce6231.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/42.20182743.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/43.73a6e48a.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/44.65314a06.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/45.393d8f29.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/46.fbe57994.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/47.49cc1b86.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/48.bf2fe551.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/49.18f3443d.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/5.01746746.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/6.092e0512.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/7.7127d660.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/8.657455e0.js"><link rel="prefetch" href="/Rancher-on-SimpliVity/MVI1/assets/js/9.306d57f0.js">
    <link rel="stylesheet" href="/Rancher-on-SimpliVity/MVI1/assets/css/0.styles.1c70c719.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Rancher-on-SimpliVity/MVI1/" class="home-link router-link-active"><!----> <span class="site-name">Rancher on HPE SimpliVity</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/blog/" class="nav-link">
  Blog
</a></div> <a href="https://github.com/Rancher-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Rancher-on-SimpliVity/MVI1/blog/" class="nav-link">
  Blog
</a></div> <a href="https://github.com/Rancher-on-SimpliVity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Rancher-on-SimpliVity/MVI1/summary.html" class="sidebar-link">Executive summary</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Preparing the environment </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Configuring the solution</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/ansible-config.html" class="sidebar-link">Ansible configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/proxy-config.html" class="sidebar-link">Proxy configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/edit-hosts.html" class="sidebar-link">Editing the hosts file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vmware-config.html" class="sidebar-link">VMware configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/simplivity-config.html" class="sidebar-link">HPE SimpliVity configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/networking-config.html" class="sidebar-link">Networking configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-config.html" class="active sidebar-link">Admin cluster and Rancher server configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-config.html#rancher-configuration" class="sidebar-link">Rancher configuration</a></li><li class="sidebar-sub-header"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-config.html#ssl-tls-configuration" class="sidebar-link">SSL/TLS configuration</a></li></ul></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html" class="sidebar-link">Rancher user cluster configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/lbs-config.html" class="sidebar-link">Load balancer configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/csi-storage-config.html" class="sidebar-link">Container Storage Interface (CSI) configuration</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/group-vars.html" class="sidebar-link">Inventory group variables</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/edit-vault.html" class="sidebar-link">Protecting sensitive information</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vars-sample.html" class="sidebar-link">Sample vars file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/vault-sample.html" class="sidebar-link">Sample vault file</a></li><li><a href="/Rancher-on-SimpliVity/MVI1/config-core/hosts-sample.html" class="sidebar-link">Sample hosts file</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Running the playbooks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Post deployment tasks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Appendices</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="admin-cluster-and-rancher-server-configuration"><a href="#admin-cluster-and-rancher-server-configuration" class="header-anchor">#</a> Admin cluster and Rancher server configuration</h1> <p>The playbooks deploy an admin cluster and a separate user cluster. The user cluster
is deployed from the Rancher server installed on the admin cluster and the configuration for the user cluster is
documented <a href="rancher-user-config">here</a>.</p> <p>The nodes in the admin cluster are determined by the
entries in the <code>hosts</code> file and are provisioned by the playbooks based on the configuration in this section.</p> <p>General configuration variables are shown in the table below:</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>cluster_name</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Name of the K8S admin cluster</td></tr> <tr><td style="text-align:left;"><code>admin_folder</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Folder and pool name for Rancher admin cluster VMs and templates</td></tr> <tr><td style="text-align:left;"><code>admin_template</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Name for the admin template</td></tr></tbody></table> <p>If the <code>admin_template</code> already exists, it is used when provisioning the VMs for the admin cluster and
the load balancers. Otherwise, this template is created from the default Ubuntu OVA
specified in the file <code>playbooks/roles/kits/tasks/main.yml</code> and then used when provisioning the VMs.</p> <h2 id="rancher-configuration"><a href="#rancher-configuration" class="header-anchor">#</a> Rancher configuration</h2> <p>Rancher configuration is specified using the <code>rancher</code> dictionary element in the <code>group_vars/all/vars.yml</code> file:</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:left;">File</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>rancher.url</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">FQDN at which Rancher Server can be reached</td></tr> <tr><td style="text-align:left;"><code>rancher.hostname</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Usually the same FQDN as the one in <code>rancher.url</code> but not necessarily</td></tr> <tr><td style="text-align:left;"><code>rancher.validate_certs</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;"><code>False</code></td></tr> <tr><td style="text-align:left;"><code>rancher.apiversion</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Playbooks designed for v3 of the API</td></tr> <tr><td style="text-align:left;"><code>rancher.engineInstallURL</code></td> <td style="text-align:left;">group_vars/all/vars.yml</td> <td style="text-align:left;">Location of script for installing Docker on all node templates</td></tr></tbody></table> <p>An example <code>rancher</code> structure is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>rancher:
  url: https://lb1.hpe.org
  hostname: lb1.hpe.org
  validate_certs: False
  apiversion: v3
  engineInstallURL: 'https://releases.rancher.com/install-docker/19.03.sh'
</code></pre></div><h2 id="ssl-tls-configuration"><a href="#ssl-tls-configuration" class="header-anchor">#</a> SSL/TLS configuration</h2> <p>Rancher Server is designed to be secure by default and requires SSL/TLS configuration. There are three options for the source of the certificates:</p> <ol><li>Rancher Generated Certificates</li> <li>Let's Encrypt</li> <li>Certificates from Files</li></ol> <p>These playbooks support option 1 and option 3. You specify which one to use by configuring the variable <code>rancher.tls_source</code> in <code>group_vars/all/vars.yml</code>. The accepted values are <code>rancher</code> for option 1, and <code>secret</code> for option 3. The default is <code>rancher</code> which means that the example above is equivalent to what is shown below:</p> <div class="language- extra-class"><pre class="language-text"><code>rancher:
  url: https://rancher.hpe.org
  hostname: rancher.hpe.org
  version: 2.3.6
  validate_certs: False
  apiversion: v3
  engineInstallURL: 'https://releases.rancher.com/install-docker/19.03.sh'
  tls_source: rancher
</code></pre></div><p>If you want to supply your own certificates, you need to set <code>rancher.tls_source</code> to <code>secret</code> and let the playbooks know where to find your certificates as shown in the example below:</p> <div class="language- extra-class"><pre class="language-text"><code>rancher:
  url: https://rancher.hpe.org
  hostname: rancher.hpe.org
  validate_certs: False
  apiversion: v3
  engineInstallURL: 'https://releases.rancher.com/install-docker/19.03.sh'
  tls_source: secret
  tls_privateCA: true
  tls_cacert_file: /home/core/certs/cacerts.pem
  tls_certchain_file: /home/core/certs/cachain.pem
  tls_certkey_file: /home/core/certs/tlskey.pem
</code></pre></div><p>The <code>rancher.tls_privateCA</code> variable is set to <code>true</code> if the certificates are signed by a private root Certificate Authority (root CA). In this case, you need to supply the certificate of the root CA using <code>rancher.tls_cacert_file</code>. In the example above, the root CA certificate was stored in <code>/home/core/certs/cacerts.pem</code>. Note that all certificates use the PEM format.</p> <p>The certificate and key that the Rancher Server should used is specified with the variables <code>rancher.tls_certchain_file</code> and <code>rancher.tls_certkey_file</code>. These variables should be configured with the names of the files that contain the SSL certificate and key that the Rancher Server should use. Note that the file designated by <code>rancher.tls_certchain_file</code> contains the certificate of the Rancher Server itself, followed by the certificates of intermediate CAs if any.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/HewlettPackard/Rancher-on-SimpliVity/edit/docs-dev/docs-src/config-core/rancher-config.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Rancher-on-SimpliVity/MVI1/config-core/networking-config.html" class="prev">
        Networking configuration
      </a></span> <span class="next"><a href="/Rancher-on-SimpliVity/MVI1/config-core/rancher-user-config.html">
        Rancher user cluster configuration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Rancher-on-SimpliVity/MVI1/assets/js/app.f53704fe.js" defer></script><script src="/Rancher-on-SimpliVity/MVI1/assets/js/2.753eaf12.js" defer></script><script src="/Rancher-on-SimpliVity/MVI1/assets/js/3.edbce201.js" defer></script><script src="/Rancher-on-SimpliVity/MVI1/assets/js/20.9c939912.js" defer></script>
  </body>
</html>
